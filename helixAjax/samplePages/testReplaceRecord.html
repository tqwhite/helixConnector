<!DOCTYPE html>
<html lang="en">
<head>
	<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=UTF-8'>
	
	<!-- META http-equiv="refresh" content="5;URL=http://somewhere.com" -->
	
	<title>Template Page Title</title>
	
	<script type='text/javascript' src='http://code.jquery.com/jquery-2.1.4.js'></script>
	<!--link rel='stylesheet' type='text/css' href='css/main.css' /-->
	
	<style type='text/css'><!--
		body {
			color:#4B92D1;
			font-family:sans-serif;padding:100px;font-size:150%;line-height:2;
		}
		.instructions{
			color:#666;
			font-size:80%;
			line-height:1;
			margin-bottom:20px;
		}
		
		#saveButton{
			margin:15px 0px;
		}
		
		.listItem{
			cursor:pointer;
		}
		.listItem:hover{
			background:#eee;
		}
	--></style>
	
</head>
<body>
<div style='color:#d88';'>Helix Connector Edit Record Page</div>
<div class='instructions'>
enter some records and the click this: <a href='/testListQuery'>Listing Page</a><br/>
enter textField10 as <b>'animals'</b> or <b>'colors'</b><br/>for an easy listing demo<br/>
</div>

<form method='post' action='upTest1_Enter_SevenFields'>
textField01!! <select name='textField01' style='font-size:150%;width:250px;height:85px;padding:10px;'>
<option value='animals'>animals</options>
<option value='colors'>colors</options>
</select><br/>
textField02 <input type='text' name='textField02' value='' style='height:50px;width:250px;font-size:150%;'><br/>
textField02 <input type='text' name='textField03' value='FROM BROWSER' style='height:50px;width:350px;font-size:100%;'><br/>
<div id='saveButton' style='cursor:pointer;text-align:center;border:1pt solid gray;height:50px;width:150px; background:#f2f2f2; color:#666; border-radius: 10px;'>SAVE</div>
<input type='hidden' name='recNum' value=''>
<div id='listing' style='font-size:18pt;'>
</div>
</form>
	
</body>

<script type='text/javascript'>
	/* <![CDATA[ */
	$(document).ready(function() {
		var updateForm=function(data, textStatus, jqXHR){

$('[name="textField01"]').val(data[0].textField01);
$('[name="textField02"]').val(data[0].textField02);
$('[name="textField03"]').val(data[0].textField03);
$('[name="recNum"]').val(data[0].recNum);


		}
		
		var getRecord = function(event) {
			var recNum = $(this).attr('id');
			
			$.ajax({
					method: "GET",
					url: "upTest1_RetrieveOnRecNum",
					data:{recNum:recNum},
					headers: {
						authorization: "<!userId!> <!authToken!>"
					}
				})
				.done(updateForm)
				.fail(function() {
					console.log("error");
				})
				.always(function() {
				console.log("complete");
			});
		
		}
		var buildList = function(data, textStatus, jqXHR) {

			var listingString = '';
			for (var i = 0, len = data.length; i < len; i++) {
				var element = data[i];
				listingString += "<div class='listItem' id='" + element.recNum + "'>";
				for (var j in element) {
					listingString += element[j] + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
				}
				listingString += "</div>";
			}

			$('#listing').html(listingString);
			$('.listItem').bind('click', getRecord);
		};

		var updateList = function() {
			$.ajax({
					method: "GET",
					url: "upTest1_RetrieveAll",
					headers: {
						authorization: "<!userId!> <!authToken!>"
					}
				})
				.done(buildList)
				.fail(function() {
					console.log("error");
				})
				.always(function() {
				console.log("complete");
			});
		}
		$('#saveButton').click(function() {

			var outObj = {};

			$('select').each(function(inx, item) {
				var name = $(item).attr('name');
				var value = $(item).val();
				outObj[name] = value;
			});

			$('input').each(function(inx, item) {
				var name = $(item).attr('name');
console.log("name="+name);


				var value = $(item).val();
console.dir({"value":value});


				outObj[name] = value;
			});

			$.ajax({
					method: "POST",
					url: "upTest1_Enter_SevenFields",
					data: outObj,
					headers: {
						authorization: "<!userId!> <!authToken!>"
					}
				})
				.done(function(msg) {
					updateList()
				})
				.fail(function(data, textStatus) {
				var errorString = "Server Error: " + data.status + " - " + data.statusText + " (" + data.responseText + ")";

				$('#listing').html(errorString);
			});
		});
		updateList()

	});



	/* ]]> */
</script>

</html>